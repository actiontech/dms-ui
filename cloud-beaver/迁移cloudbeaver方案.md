# 迁移 cb 至 DMS 仓库方案

主要方向：在 dms ui 仓库新建 package，可直接复用 dms 现有的 UI 组件、主题变量、dms 的API

cb 的 gql 的 sdk 服务生成问题：修改 gql 的生成配置文件即可

   `cloud-beaver/packages/core-sdk/codegen.ts`

    在 cb 原仓库中，schema 字段配置的为同仓库中 server 下的 gql 定义，可直接调整为 gql 服务端点即可正常生成，例如：<http://localhost:8978/api/gql>

## 迁移实施方案

1. 保留 cb 大部分的现有框架，例如各个包的结构，只在迁移过程中调整组件的样式方案以及部分可替换的公共组件，例如 Button、Modal 之类的公共组件，保留 cb 的大部分逻辑
2. 考虑到迁移成本，保留依赖注入的核心实现，这样能够有最小的逻辑部分代码的改动（考虑了几种替代方案，但是变动都会比较大）
3. 优化 cb 入口包以及路由的实现方式，改为 tanstack 路由
4. 调整语言包的实现方案， 见 core-localization 包（暂定，后续可能会还原）
5. 多仓库管理方案直接调整为 pnpm 的方案，同时包管理器也改为 pnpm，cb 的 yarn PnP以及多仓库管理用起来有点麻烦，新建一个包需要做的事情也比较麻烦
6. vite 相关配置大部分会继承，是否添加条件编译插件需要和后端同步后再确认，因为之前讨论过 cb 不希望也有多个编译命令
7. 对于 cb 现有不需要的功能或者说非必需功能考虑不进行迁移，例如 登录、成员配置、管理员系统设置相关的功能可以直接不进行迁移，非必需包，例如 cb 的圣诞节彩蛋包也是不用迁移的。
8. 考虑对 cb 的组件组织形式在迁移过程中进行调整，例如移除过多组件层级以及 useContext， 尽量统一使用 mobx 来管理相关状态
9. TODO

## 方案已知缺陷

后续同步 cb 最新代码问题，需要手动二次开发，但是考虑到前端方案重写的方案，也不好直接同步代码，仍然是需要解决冲突之类的处理
